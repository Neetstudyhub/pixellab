<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Posts</title>
</head>
<body>
    <h1>Latest Posts</h1>
    <div id="posts"></div>

    <script>
        async function fetchPosts() {
            try {
                const response = await fetch('https://broken-hall-68ac.earnmoney100a.workers.dev/');
                const data = await response.json();

                const postsContainer = document.getElementById('posts');
                postsContainer.innerHTML = '';

                data.items.forEach(post => {
                    let slug = post.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
                    let postUrl = `mypost/${slug}.html`;

                    let postElement = `<h2><a href="${postUrl}">${post.title}</a></h2>`;
                    postsContainer.innerHTML += postElement;
                });

                generateSitemap(data.items);
            } catch (error) {
                console.error('Error fetching posts:', error);
            }
        }

        function generateSitemap(posts) {
            let sitemapContent = `<?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n`;

            posts.forEach(post => {
                let slug = post.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
                let postUrl = `https://neetstudyhub.github.io/pixellab/mypost/${slug}.html`;

                sitemapContent += `<url>\n<loc>${postUrl}</loc>\n</url>\n`;
            });

            sitemapContent += `</urlset>`;

            fetch('sitemap.xml', { method: 'POST', body: sitemapContent }); // Save sitemap
        }

        fetchPosts();
    </script>
</body>
</html>
